CREATE TABLE ENTITY
(
	ENTITY_ID NUMBER NOT NULL,
	NAME1     VARCHAR2(50) NOT NULL,
	NAME2     VARCHAR2(50),
	NAME3     VARCHAR2(50),
	ADDRESS1   VARCHAR2(50) NOT NULL,
	ADDRESS2   VARCHAR2(50),
	CITY       VARCHAR2(50) NOT NULL,
	STATE      VARCHAR2(2) NOT NULL,
	ZIP        VARCHAR2(10) NOT NULL,
	PHONE1     VARCHAR2(15) NOT NULL,
	PHONE2     VARCHAR2(15),
	PHONE3     VARCHAR2(15)
)
/
ALTER TABLE ENTITY ADD CONSTRAINT ENTITY_PK PRIMARY KEY ( ENTITY_ID )
/
CREATE SEQUENCE ENTITY_S START WITH 1 ORDER
/

CREATE TABLE ROLES
(
	ROLE_ID   NUMBER NOT NULL,
	ROLE_NAME VARCHAR2(50) NOT NULL
)
/
ALTER TABLE ROLES ADD CONSTRAINT ROLE_PK PRIMARY KEY ( ROLE_ID )
/
ALTER TABLE ROLES ADD CONSTRAINT ROLE_UC1 UNIQUE (ROLE_NAME)
/
INSERT INTO ROLES (ROLE_ID,	ROLE_NAME) VALUES (1, 'Administrator');
INSERT INTO ROLES (ROLE_ID,	ROLE_NAME) VALUES (2, 'Office');
INSERT INTO ROLES (ROLE_ID,	ROLE_NAME) VALUES (3, 'User');

CREATE TABLE USERS
(
	USER_ID   NUMBER NOT NULL,
	ROLE_ID   NUMBER NOT NULL,
	ENTITY_ID NUMBER NULL,
	USERNAME  VARCHAR2(50) NOT NULL,
	PASSWORD  VARCHAR2(500) NOT NULL
)
/
ALTER TABLE USERS ADD CONSTRAINT USERS_PK PRIMARY KEY ( USER_ID )
/
ALTER TABLE USERS ADD CONSTRAINT USERS_FK1 FOREIGN KEY ( ENTITY_ID ) REFERENCES ENTITY ( ENTITY_ID )
/
ALTER TABLE USERS ADD CONSTRAINT USERS_FK2 FOREIGN KEY ( ROLE_ID ) REFERENCES ROLES ( ROLE_ID )
/
ALTER TABLE USERS ADD CONSTRAINT USERS_UC1 UNIQUE (USERNAME)
/
CREATE SEQUENCE USERS_S START WITH 1 ORDER
/

CREATE TABLE INSURANCE
(
	INSURANCE_ID  NUMBER NOT NULL,
	NAME          VARCHAR2(50) NOT NULL,
	POLICY_NUMBER VARCHAR2(50) NOT NULL,
	GROUP_NUMBER  VARCHAR2(50) NOT NULL
)
/
ALTER TABLE INSURANCE ADD CONSTRAINT INSURANCE_PK PRIMARY KEY ( INSURANCE_ID )
/
CREATE SEQUENCE INSURANCE_S START WITH 1 ORDER
/

CREATE TABLE HOUSEHOLD
(
	HOUSEHOLD_ID NUMBER NOT NULL,
	INSURANCE_ID NUMBER NOT NULL
)
/
ALTER TABLE HOUSEHOLD ADD CONSTRAINT HOUSEHOLD_PK PRIMARY KEY ( HOUSEHOLD_ID )
/
ALTER TABLE HOUSEHOLD ADD CONSTRAINT HOUSEHOLD_FK1 FOREIGN KEY ( INSURANCE_ID ) REFERENCES INSURANCE ( INSURANCE_ID )
/
CREATE SEQUENCE HOUSEHOLD_S START WITH 1 ORDER
/

CREATE TABLE RELATIONSHIP
(
	RELATIONSHIP_ID NUMBER NOT NULL,
	NAME            VARCHAR2(50) NOT NULL,
	PARENT_ID		    NUMBER 
)
/
ALTER TABLE RELATIONSHIP ADD CONSTRAINT RELATIONSHIP_PK PRIMARY KEY ( RELATIONSHIP_ID )
/
ALTER TABLE RELATIONSHIP ADD CONSTRAINT RELATIONSHIP_UC1 UNIQUE (NAME)
/
CREATE SEQUENCE RELATIONSHIP_S START WITH 1 ORDER
/

CREATE TABLE HOUSEHOLD_PERSON
(
	HOUSEHOLD_PERSON_ID NUMBER NOT NULL,
	RELATIONSHIP_ID     NUMBER NOT NULL,
	HOUSEHOLD_ID        NUMBER NOT NULL,
	ENTITY_ID           NUMBER NOT NULL,
	IS_PAYER            CHAR (1) NOT NULL,
	DOB					DATE
)
/
ALTER TABLE HOUSEHOLD_PERSON ADD CONSTRAINT HOUSEHOLD_PERSON_PK PRIMARY KEY ( HOUSEHOLD_PERSON_ID )
/
ALTER TABLE HOUSEHOLD_PERSON ADD CONSTRAINT HOUSEHOLD_PERSON_FK1 FOREIGN KEY ( HOUSEHOLD_ID ) REFERENCES HOUSEHOLD ( HOUSEHOLD_ID )
/
ALTER TABLE HOUSEHOLD_PERSON ADD CONSTRAINT HOUSEHOLD_PERSON_FK2 FOREIGN KEY ( ENTITY_ID ) REFERENCES ENTITY ( ENTITY_ID )
/
ALTER TABLE HOUSEHOLD_PERSON ADD CONSTRAINT HOUSEHOLD_PERSON_FK3 FOREIGN KEY ( RELATIONSHIP_ID ) REFERENCES RELATIONSHIP ( RELATIONSHIP_ID )
/
ALTER TABLE HOUSEHOLD_PERSON ADD CONSTRAINT HOUSEHOLD_PERSON_UC1 UNIQUE (HOUSEHOLD_ID, ENTITY_ID)
/
CREATE SEQUENCE HOUSEHOLD_PERSON_S START WITH 1 ORDER
/

CREATE TABLE CLINIC
(
	CLINIC_ID        NUMBER NOT NULL,
	ENTITY_ID		 NUMBER NOT NULL
)
/
ALTER TABLE CLINIC ADD CONSTRAINT CLINIC_PK PRIMARY KEY ( CLINIC_ID )
/
ALTER TABLE CLINIC ADD CONSTRAINT CLINIC_FK1 FOREIGN KEY ( ENTITY_ID ) REFERENCES ENTITY ( ENTITY_ID )
/
CREATE SEQUENCE CLINIC_S START WITH 1 ORDER
/

CREATE TABLE ROOM
(
	ROOM_ID   NUMBER NOT NULL,
	CLINIC_ID NUMBER NOT NULL,
	NAME      VARCHAR2(50) NOT NULL
)
/
ALTER TABLE ROOM ADD CONSTRAINT ROOM_PK PRIMARY KEY ( ROOM_ID )
/
ALTER TABLE ROOM ADD CONSTRAINT ROOM_FK1 FOREIGN KEY ( CLINIC_ID ) REFERENCES CLINIC ( CLINIC_ID )
/
CREATE SEQUENCE ROOM_S START WITH 1 ORDER
/

CREATE TABLE SERVICE
(
	SERVICE_ID NUMBER NOT NULL,
	CLINIC_ID  NUMBER NOT NULL,
	NAME       VARCHAR2(50) NOT NULL,
	COST       NUMBER (6,2) NOT NULL
)
/
ALTER TABLE SERVICE ADD CONSTRAINT SERVICE_PK PRIMARY KEY ( SERVICE_ID )
/
ALTER TABLE SERVICE ADD CONSTRAINT SERVICE_FK1 FOREIGN KEY ( CLINIC_ID ) REFERENCES CLINIC ( CLINIC_ID )
/
ALTER TABLE SERVICE ADD CONSTRAINT SERVICE_UC1 UNIQUE (CLINIC_ID, NAME)
/
CREATE SEQUENCE SERVICE_S START WITH 1 ORDER
/

CREATE TABLE PROVIDER
(
	PROVIDER_ID NUMBER NOT NULL,
	CLINIC_ID   NUMBER NOT NULL,
	ENTITY_ID   NUMBER NOT NULL
)
/
ALTER TABLE PROVIDER ADD CONSTRAINT PROVIDER_PK PRIMARY KEY ( PROVIDER_ID )
/
ALTER TABLE PROVIDER ADD CONSTRAINT PROVIDER_FK1 FOREIGN KEY ( CLINIC_ID ) REFERENCES CLINIC ( CLINIC_ID )
/
ALTER TABLE PROVIDER ADD CONSTRAINT PROVIDER_FK2 FOREIGN KEY ( ENTITY_ID ) REFERENCES ENTITY ( ENTITY_ID )
/
CREATE SEQUENCE PROVIDER_S START WITH 1 ORDER
/

CREATE TABLE PROVIDER_QUALIFICATION
(
	PROVIDER_QUALIFICATION_ID NUMBER NOT NULL,
	PROVIDER_ID               NUMBER NOT NULL,
  SERVICE_ID                NUMBER NOT NULL
)
/
ALTER TABLE PROVIDER_QUALIFICATION ADD CONSTRAINT PROVIDER_QUALIFICATION_PK PRIMARY KEY ( PROVIDER_QUALIFICATION_ID )
/
ALTER TABLE PROVIDER_QUALIFICATION ADD CONSTRAINT PROVIDER_QUALIFICATION_FK1 FOREIGN KEY ( PROVIDER_ID ) REFERENCES PROVIDER ( PROVIDER_ID )
/
ALTER TABLE PROVIDER_QUALIFICATION ADD CONSTRAINT PROVIDER_QUALIFICATION_FK2 FOREIGN KEY ( SERVICE_ID ) REFERENCES SERVICE ( SERVICE_ID )
/
ALTER TABLE PROVIDER_QUALIFICATION ADD CONSTRAINT PROVIDER_QUALIFICATION_UC1 UNIQUE (PROVIDER_ID, SERVICE_ID)
/
CREATE SEQUENCE PROVIDER_QUALIFICATION_S START WITH 1 ORDER
/

CREATE TABLE APPOINTMENT
(
	APPOINTMENT_ID      NUMBER NOT NULL,
	CLINIC_ID           NUMBER NOT NULL,
	HOUSEHOLD_PERSON_ID NUMBER NOT NULL
)
/
ALTER TABLE APPOINTMENT ADD CONSTRAINT APPOINTMENT_PK PRIMARY KEY ( APPOINTMENT_ID ) 
/
ALTER TABLE APPOINTMENT ADD CONSTRAINT APPOINTMENT_FK1 FOREIGN KEY ( HOUSEHOLD_PERSON_ID ) REFERENCES HOUSEHOLD_PERSON ( HOUSEHOLD_PERSON_ID ) 
/ 
CREATE SEQUENCE APPOINTMENT_S START WITH 1 ORDER
/

CREATE TABLE APPOINTMENT_SERVICE
(
	APPOINTMENT_SERVICE_ID NUMBER NOT NULL,
	APPOINTMENT_ID         NUMBER NOT NULL,
	PROVIDER_ID            NUMBER NOT NULL,
	SERVICE_ID             NUMBER NOT NULL,
	ROOM_ID                NUMBER NOT NULL,
	COST                   NUMBER (6,2) NOT NULL,
	TIME                   DATE NOT NULL,
	MINUTES                NUMBER NOT NULL
)
/
ALTER TABLE APPOINTMENT_SERVICE ADD CONSTRAINT APPOINTMENT_SERVICE_PK PRIMARY KEY ( APPOINTMENT_SERVICE_ID )
/
ALTER TABLE APPOINTMENT_SERVICE ADD CONSTRAINT APPOINTMENT_SERVICE_FK1 FOREIGN KEY ( APPOINTMENT_ID ) REFERENCES APPOINTMENT ( APPOINTMENT_ID )
/
ALTER TABLE APPOINTMENT_SERVICE ADD CONSTRAINT APPOINTMENT_SERVICE_FK2 FOREIGN KEY ( SERVICE_ID ) REFERENCES SERVICE ( SERVICE_ID )
/
ALTER TABLE APPOINTMENT_SERVICE ADD CONSTRAINT APPOINTMENT_SERVICE_FK3 FOREIGN KEY ( ROOM_ID ) REFERENCES ROOM ( ROOM_ID )
/
ALTER TABLE APPOINTMENT_SERVICE ADD CONSTRAINT APPOINTMENT_SERVICE_FK4 FOREIGN KEY ( PROVIDER_ID ) REFERENCES PROVIDER ( PROVIDER_ID )
/
CREATE SEQUENCE APPOINTMENT_SERVICE_S START WITH 1 ORDER
/

CREATE TABLE PAYMENT
(
	PAYMENT_ID     NUMBER NOT NULL,
	APPOINTMENT_ID NUMBER NOT NULL,
	PAYMENT        NUMBER (6,2) NOT NULL
)
/
ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_PK PRIMARY KEY ( PAYMENT_ID )
/
ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_FK1 FOREIGN KEY ( APPOINTMENT_ID ) REFERENCES APPOINTMENT ( APPOINTMENT_ID )
/
CREATE SEQUENCE PAYMENT_S START WITH 1 ORDER
/
COMMIT;